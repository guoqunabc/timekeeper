<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimeKeeper å…¼å®¹æ€§æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .pass { background: #004d00; }
        .fail { background: #4d0000; }
        .unknown { background: #4d4d00; }
        h1, h2 { color: #ffcc00; }
    </style>
</head>
<body>
    <h1>ğŸ§ª TimeKeeper å…¼å®¹æ€§æµ‹è¯•æŠ¥å‘Š</h1>
    
    <h2>æµè§ˆå™¨ä¿¡æ¯</h2>
    <div id="browserInfo"></div>
    
    <h2>å…³é”®åŠŸèƒ½æ”¯æŒæ£€æµ‹</h2>
    <div id="featureTests"></div>
    
    <h2>æ€§èƒ½æµ‹è¯•</h2>
    <div id="performanceTests"></div>
    
    <script>
        // æµè§ˆå™¨ä¿¡æ¯æ£€æµ‹
        function detectBrowser() {
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine
            };
            
            document.getElementById('browserInfo').innerHTML = `
                <div class="test-item pass">
                    <strong>User Agent:</strong> ${info.userAgent}<br>
                    <strong>å¹³å°:</strong> ${info.platform}<br>
                    <strong>è¯­è¨€:</strong> ${info.language}<br>
                    <strong>Cookieæ”¯æŒ:</strong> ${info.cookieEnabled ? 'âœ…' : 'âŒ'}<br>
                    <strong>åœ¨çº¿çŠ¶æ€:</strong> ${info.onLine ? 'âœ…' : 'âŒ'}
                </div>
            `;
        }
        
        // åŠŸèƒ½æ”¯æŒæ£€æµ‹
        function runFeatureTests() {
            const tests = [
                {
                    name: 'localStorage æ”¯æŒ',
                    test: () => {
                        try {
                            localStorage.setItem('test', 'value');
                            localStorage.removeItem('test');
                            return true;
                        } catch (e) {
                            return false;
                        }
                    }
                },
                {
                    name: 'setInterval/clearInterval æ”¯æŒ',
                    test: () => typeof setInterval === 'function' && typeof clearInterval === 'function'
                },
                {
                    name: 'Date.now() æ”¯æŒ',
                    test: () => typeof Date.now === 'function'
                },
                {
                    name: 'JSON æ”¯æŒ',
                    test: () => typeof JSON === 'object' && typeof JSON.parse === 'function'
                },
                {
                    name: 'addEventListener æ”¯æŒ',
                    test: () => typeof document.addEventListener === 'function'
                },
                {
                    name: 'querySelector æ”¯æŒ',
                    test: () => typeof document.querySelector === 'function'
                },
                {
                    name: 'classList æ”¯æŒ',
                    test: () => {
                        const div = document.createElement('div');
                        return typeof div.classList === 'object';
                    }
                },
                {
                    name: 'CSS åŠ¨ç”»æ”¯æŒ',
                    test: () => {
                        const div = document.createElement('div');
                        return 'animation' in div.style || 'webkitAnimation' in div.style;
                    }
                },
                {
                    name: 'Blob å’Œ URL.createObjectURL æ”¯æŒï¼ˆCSVå¯¼å‡ºéœ€è¦ï¼‰',
                    test: () => typeof Blob === 'function' && typeof URL.createObjectURL === 'function'
                }
            ];
            
            let html = '';
            tests.forEach(test => {
                try {
                    const result = test.test();
                    const status = result ? 'pass' : 'fail';
                    const icon = result ? 'âœ…' : 'âŒ';
                    html += `<div class="test-item ${status}">${icon} ${test.name}</div>`;
                } catch (e) {
                    html += `<div class="test-item fail">âŒ ${test.name} (é”™è¯¯: ${e.message})</div>`;
                }
            });
            
            document.getElementById('featureTests').innerHTML = html;
        }
        
        // æ€§èƒ½æµ‹è¯•
        function runPerformanceTests() {
            const tests = [
                {
                    name: 'å®šæ—¶å™¨ç²¾åº¦æµ‹è¯•',
                    test: () => {
                        return new Promise((resolve) => {
                            const start = Date.now();
                            setTimeout(() => {
                                const end = Date.now();
                                const diff = Math.abs((end - start) - 1000);
                                resolve(`å»¶è¿Ÿ: ${diff}ms ${diff < 100 ? 'âœ…' : 'âš ï¸'}`);
                            }, 1000);
                        });
                    }
                },
                {
                    name: 'DOM æ“ä½œæ€§èƒ½',
                    test: () => {
                        const start = performance.now();
                        for (let i = 0; i < 1000; i++) {
                            const div = document.createElement('div');
                            div.textContent = `æµ‹è¯•å…ƒç´  ${i}`;
                        }
                        const end = performance.now();
                        const time = (end - start).toFixed(2);
                        return Promise.resolve(`åˆ›å»º1000ä¸ªå…ƒç´ è€—æ—¶: ${time}ms ${time < 100 ? 'âœ…' : 'âš ï¸'}`);
                    }
                },
                {
                    name: 'localStorage è¯»å†™æ€§èƒ½',
                    test: () => {
                        const start = performance.now();
                        const testData = JSON.stringify(Array(1000).fill().map((_, i) => ({
                            id: i,
                            name: `æµ‹è¯•è®°å½•${i}`,
                            time: Date.now()
                        })));
                        
                        localStorage.setItem('performanceTest', testData);
                        const retrieved = localStorage.getItem('performanceTest');
                        const parsed = JSON.parse(retrieved);
                        localStorage.removeItem('performanceTest');
                        
                        const end = performance.now();
                        const time = (end - start).toFixed(2);
                        return Promise.resolve(`1000æ¡è®°å½•è¯»å†™è€—æ—¶: ${time}ms ${time < 50 ? 'âœ…' : 'âš ï¸'}`);
                    }
                }
            ];
            
            const container = document.getElementById('performanceTests');
            container.innerHTML = '<div class="test-item unknown">ğŸ”„ æ€§èƒ½æµ‹è¯•è¿›è¡Œä¸­...</div>';
            
            Promise.all(tests.map(async test => {
                try {
                    const result = await test.test();
                    return `<div class="test-item pass">ğŸ“Š ${test.name}: ${result}</div>`;
                } catch (e) {
                    return `<div class="test-item fail">âŒ ${test.name}: é”™è¯¯ ${e.message}</div>`;
                }
            })).then(results => {
                container.innerHTML = results.join('');
            });
        }
        
        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        detectBrowser();
        runFeatureTests();
        runPerformanceTests();
        
        // æ·»åŠ åˆ·æ–°æŒ‰é’®
        document.body.insertAdjacentHTML('beforeend', `
            <div style="margin-top: 20px;">
                <button onclick="location.reload()" style="padding: 10px 20px; background: #ffcc00; color: black; border: none; border-radius: 5px; cursor: pointer;">
                    ğŸ”„ é‡æ–°æµ‹è¯•
                </button>
                <button onclick="window.open('index.html')" style="padding: 10px 20px; background: #007acc; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
                    ğŸš€ æ‰“å¼€ TimeKeeper
                </button>
            </div>
        `);
    </script>
</body>
</html> 